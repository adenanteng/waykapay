import{T as E,i as M,d as m,s as P,o as x,e as k,b as o,w as r,F as A,Q as D,a as s,t as b,g,u as c,n as F,f as T}from"./app-61f03d6b.js";import{_ as U}from"./ActionMessage-5bc788ad.js";import{_ as R}from"./FormSection-d0f16ca9.js";import{_ as $}from"./InputError-e1b2d35a.js";import{_ as N}from"./InputLabel-2b8e8042.js";import{_ as z}from"./PrimaryButton-4fa843f0.js";import{_ as K}from"./TextInput-a2cfc6de.js";import{_ as q}from"./ActionSection-655d93dc.js";import{_ as L}from"./TextAreaInput-7c341bc7.js";import{e as S}from"./vue3-otp-input.esm-f98c23eb.js";import{b as Q}from"./bcrypt-616c4c59.js";import{a as G}from"./DialogModal-fc6954da.js";import{P as H,E as J}from"./echo-9a375d7c.js";import"./SectionTitle-2a9def9e.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./_commonjs-dynamic-modules-302442b1.js";const W={class:"flex items-center px-2"},X={class:"flex-shrink-0"},Y=["src","alt"],Z={class:"ml-3 min-w-0 flex-1"},ee={class:"text-base font-medium text-gray-800 truncate capitalize"},ae={class:"text-sm font-medium text-gray-500 truncate"},se={class:"col-span-6 sm:col-span-3"},ne={class:"flex"},oe=s("span",{class:"flex items-center bg-white text-black border border-gray-300 border-r-0 rounded-3xl rounded-r-none shadow-sm mt-1 px-3"}," Rp ",-1),te={class:"mt-1 text-xs text-gray-600"},le={class:"col-span-6 sm:col-span-4"},re=s("div",{class:"w-full text-center"}," Masukkan PIN transaksi kamu ",-1),ce={class:"grid justify-center"},ie={key:0,class:"w-full text-center text-sm text-red-600 mt-2"},Se={__name:"UpdateInformationForm",props:{users:Object|String,beneficiary:Object|String,token:String,response:Object|String,bank:Object,account_no:String},setup(I){const t=I,l=E({amount:null,bank:t.bank,account_no:t.account_no,desc:null,beneficiary:t.beneficiary??null,token:t.token??null}),{..._}=M(()=>D().props.user).value,v=m(null),h=()=>{Number(i.value)>=Number(_.wallet_balance)?(f.value=!1,v.value="Saldo kurang"):t.beneficiary?(l.amount=i.value,l.post(route("money-transfer.confirmAyo"),{errorBag:"storeInformation",preserveScroll:!0,replace:!0,onSuccess:()=>{var e;(e=d.value)==null||e.clearInput()}})):(l.amount=i.value.replaceAll(".",""),l.post(route("money-transfer.confirm"),{errorBag:"storeInformation",preserveScroll:!0,replace:!0,onSuccess:()=>{var e;(e=d.value)==null||e.clearInput()}}))};function C(e){return(e/1).toFixed(0).replace(".","").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}const i=m(null);P(i,e=>{i.value=e.toString().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,".")});const f=m(!1),d=m(S|null),y=m(""),w=m(!1),V=()=>{_.pin?f.value=!0:h()},B=()=>{f.value=!1},O=e=>{let a=e;a=a.replace(/^\$2y(.+)$/i,"$2a$1"),Q.compare(a,_.pin,function(n,u){var p;u?h():(w.value=!0,(p=d.value)==null||p.clearInput())})},j=e=>{};return typeof window<"u"&&(window.Pusher=H,window.Echo=new J({broadcaster:"pusher",key:"e4c42e8e3951c6ee37f6",cluster:"ap1",forceTLS:!0}),window.Echo.channel("ayo-beneficiary-channel").listen(".ayo-beneficiary-event",function(a){var n,u;a.action==="reload"&&((u=(n=t.beneficiary)==null?void 0:n.beneficiaryDetails)==null?void 0:u.beneficiaryAccountNumber)==a.beneficiaryAccountNumber?console.log(a.action,a.beneficiaryAccountNumber):console.log(a)})),(e,a)=>(x(),k(A,null,[o(q,null,{title:r(()=>[]),description:r(()=>[]),content:r(()=>{var n,u,p;return[s("div",W,[s("div",X,[s("img",{class:"h-5 w-full",src:t.bank.logo,alt:t.bank.name},null,8,Y)]),s("div",Z,[s("div",ee,b(((n=t.users)==null?void 0:n.name)??((p=(u=t.beneficiary)==null?void 0:u.beneficiaryDetails)==null?void 0:p.beneficiaryName)),1),s("div",ae,b(t.account_no),1)])])]}),_:1}),o(R,null,{title:r(()=>[g(" Mau Transfer berapa? ")]),description:r(()=>[]),form:r(()=>[s("div",se,[o(N,{for:"amount",value:"Nominal"}),s("div",ne,[oe,o(K,{id:"amount",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=n=>i.value=n),type:"tel",class:"mt-1 block w-full rounded-l-none",min:"1",max:Number(e.$page.props.user.wallet_balance)<=2e6?e.$page.props.user.wallet_balance:2e6,required:"",autofocus:""},null,8,["modelValue","max"])]),o($,{message:c(l).errors.amount||v.value,class:"mt-2"},null,8,["message"]),s("p",te," Nominal Rp 1.000 - Rp "+b(Number(e.$page.props.user.wallet_balance)<=2e6?C(e.$page.props.user.wallet_balance):"2.000.000"),1)]),s("div",le,[o(N,{for:"amount",value:"Keterangan"}),o(L,{id:"desc",modelValue:c(l).desc,"onUpdate:modelValue":a[1]||(a[1]=n=>c(l).desc=n),type:"text",class:"mt-1 block w-full",rows:"1"},null,8,["modelValue"]),o($,{message:c(l).errors.desc,class:"mt-2"},null,8,["message"])])]),actions:r(()=>[o(U,{on:c(l).recentlySuccessful,class:"mr-3"},{default:r(()=>[g(" Berhasil disimpan. ")]),_:1},8,["on"]),o(z,{class:F(["w-full justify-center",{"opacity-25":c(l).processing}]),disabled:c(l).processing,onClick:V},{default:r(()=>[g(" Konfirmasi ")]),_:1},8,["class","disabled"])]),_:1}),o(G,{show:f.value,onClose:B},{title:r(()=>[re]),content:r(()=>[s("div",ce,[o(c(S),{ref_key:"otpInput",ref:d,value:y.value,"onUpdate:value":a[2]||(a[2]=n=>y.value=n),"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",conditionalClass:["one","two","three","four","five","six"],onOnChange:j,onOnComplete:O},null,8,["value"]),w.value?(x(),k("p",ie,"Pin salah, silahkan coba lagi.")):T("",!0)])]),_:1},8,["show"])],64))}};export{Se as default};
