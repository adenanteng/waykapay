import{T as U,k as z,d as c,p as F,z as T,D as K,o as i,e as f,b as l,w as r,c as R,f as I,F as C,Q as q,a,t as d,g as x,u,n as L}from"./app-CaR_YMvJ.js";import{_ as Q}from"./ActionMessage-DIDKVRWk.js";import{_ as G}from"./FormSection-CwZIVMs-.js";import{_ as V}from"./InputError-Br9kkj1v.js";import{_ as A}from"./InputLabel-_3f3Vnbu.js";import{_ as H}from"./PrimaryButton-XpxRpvCD.js";import{_ as J}from"./TextInput-DRNSVejG.js";import{_ as W}from"./ActionSection-WzkicrO5.js";import{_ as X}from"./TextAreaInput-C3jz4xxb.js";import{e as B}from"./vue3-otp-input.esm-MqEmeBIT.js";import{b as Y}from"./bcrypt-DdGEf7Be.js";import{a as Z}from"./DialogModal-B_9Q7Wv1.js";import{P as ee,E as ae}from"./echo-Bm584l7I.js";import"./SectionTitle-xs512UXh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const se={key:0,class:"flex items-center px-2"},te={class:"flex-shrink-0"},ne=["src","alt"],oe={class:"ml-3 min-w-0 flex-1"},le={class:"text-base font-medium text-gray-800 truncate capitalize"},re={class:"text-sm font-medium text-gray-500 truncate"},ce={key:1,class:"text-center"},ie=a("i",{class:"fa-regular fa-triangle-exclamation text-2xl text-red-600"},null,-1),ue={class:"text-gray-900"},me={key:2,class:"fa-regular fa-spinner-third animate-spin"},fe={key:1,class:"flex items-center px-2"},de={class:"flex-shrink-0"},pe=["src","alt"],_e={class:"ml-3 min-w-0 flex-1"},be={class:"text-base font-medium text-gray-800 truncate capitalize"},ye={class:"text-sm font-medium text-gray-500 truncate"},ve={class:"col-span-6 sm:col-span-3"},ge={class:"flex"},he=a("span",{class:"flex items-center bg-white text-black border border-gray-300 border-r-0 rounded-3xl rounded-r-none shadow-sm mt-1 px-3"}," Rp ",-1),xe={class:"mt-1 text-xs text-gray-600"},ke={class:"col-span-6 sm:col-span-4"},we=a("div",{class:"w-full text-center"}," Masukkan PIN transaksi kamu ",-1),Ne={class:"grid justify-center"},$e={key:0,class:"w-full text-center text-sm text-red-600 mt-2"},Ke={__name:"UpdateInformationForm",props:{users:Object|String,beneficiary:Object|String,token:String,response:Object|String,bank:Object,account_no:String},setup(M){const t=M,n=U({amount:null,bank:t.bank,account_no:t.account_no,desc:null,beneficiary:t.beneficiary??null,token:t.token??null}),{...g}=z(()=>q().props.user).value,k=c(null),w=()=>{Number(m.value)>=Number(g.wallet_balance)?(b.value=!1,k.value="Saldo kurang"):t.beneficiary?(n.amount=m.value.replaceAll(".",""),n.beneficiary.beneficiaryDetails.beneficiaryName=p.value,n.post(route("money-transfer.confirmAyo"),{errorBag:"storeInformation",preserveScroll:!0,replace:!0,onSuccess:()=>{var s;(s=y.value)==null||s.clearInput()}})):(n.amount=m.value.replaceAll(".",""),n.post(route("money-transfer.confirm"),{errorBag:"storeInformation",preserveScroll:!0,replace:!0,onSuccess:()=>{var s;(s=y.value)==null||s.clearInput()}}))};function O(s){return(s/1).toFixed(0).replace(".","").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}const m=c(null);F(m,s=>{m.value=s.toString().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,".")});const b=c(!1),y=c(B|null),N=c(""),$=c(!1),E=()=>{g.pin?b.value=!0:w()},j=()=>{b.value=!1},D=s=>{let e=s;e=e.replace(/^\$2y(.+)$/i,"$2a$1"),Y.compare(e,g.pin,function(o,v){var _;v?w():($.value=!0,(_=y.value)==null||_.clearInput())})},P=s=>{},p=c(),h=c();return typeof window<"u"&&(window.Pusher=ee,window.Echo=new ae({broadcaster:"pusher",key:"e4c42e8e3951c6ee37f6",cluster:"ap1",forceTLS:!0}),window.Echo.channel("ayo-beneficiary-channel").listen(".ayo-beneficiary-event",function(e){var o,v,_,S;e.action==="success"&&((v=(o=t.beneficiary)==null?void 0:o.beneficiaryDetails)==null?void 0:v.beneficiaryAccountNumber)==e.beneficiaryAccountNumber?(p.value=e.beneficiaryName,console.log(e.beneficiaryName,e.beneficiaryAccountNumber)):e.action==="error"&&((S=(_=t.beneficiary)==null?void 0:_.beneficiaryDetails)==null?void 0:S.beneficiaryAccountNumber)==e.beneficiaryAccountNumber?(h.value=e.message,console.log(e.message,e.beneficiaryAccountNumber)):console.log(e)})),T(()=>{}),K(()=>{window.Echo.leave("ayo-beneficiary-channel")}),(s,e)=>(i(),f(C,null,[l(W,null,{title:r(()=>[]),description:r(()=>[]),content:r(()=>{var o;return[t.beneficiary?(i(),f("div",se,[p.value?(i(),f(C,{key:0},[a("div",te,[a("img",{class:"h-5 w-full",src:t.bank.logo,alt:t.bank.name},null,8,ne)]),a("div",oe,[a("div",le,d(p.value),1),a("div",re,d(t.account_no),1)])],64)):h.value?(i(),f("div",ce,[ie,a("p",ue,d(h.value),1)])):(i(),f("i",me))])):(i(),f("div",fe,[a("div",de,[a("img",{class:"h-5 w-full",src:t.bank.logo,alt:t.bank.name},null,8,pe)]),a("div",_e,[a("div",be,d((o=t.users)==null?void 0:o.name),1),a("div",ye,d(t.account_no),1)])]))]}),_:1}),p.value||!t.beneficiary?(i(),R(G,{key:0},{title:r(()=>[x(" Mau Transfer berapa? ")]),description:r(()=>[]),form:r(()=>[a("div",ve,[l(A,{for:"amount",value:"Nominal"}),a("div",ge,[he,l(J,{id:"amount",modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),type:"tel",class:"mt-1 block w-full rounded-l-none",min:"1",max:Number(s.$page.props.user.wallet_balance)<=2e6?s.$page.props.user.wallet_balance:2e6,required:"",autofocus:""},null,8,["modelValue","max"])]),l(V,{message:u(n).errors.amount||k.value,class:"mt-2"},null,8,["message"]),a("p",xe," Max Rp "+d(Number(s.$page.props.user.wallet_balance)<=2e6?O(s.$page.props.user.wallet_balance):"2.000.000"),1)]),a("div",ke,[l(A,{for:"amount",value:"Keterangan"}),l(X,{id:"desc",modelValue:u(n).desc,"onUpdate:modelValue":e[1]||(e[1]=o=>u(n).desc=o),type:"text",class:"mt-1 block w-full",rows:"1"},null,8,["modelValue"]),l(V,{message:u(n).errors.desc,class:"mt-2"},null,8,["message"])])]),actions:r(()=>[l(Q,{on:u(n).recentlySuccessful,class:"mr-3"},{default:r(()=>[x(" Berhasil disimpan. ")]),_:1},8,["on"]),l(H,{class:L(["w-full justify-center",{"opacity-25":u(n).processing}]),disabled:u(n).processing,onClick:E},{default:r(()=>[x(" Konfirmasi ")]),_:1},8,["class","disabled"])]),_:1})):I("",!0),l(Z,{show:b.value,onClose:j},{title:r(()=>[we]),content:r(()=>[a("div",Ne,[l(u(B),{ref_key:"otpInput",ref:y,value:N.value,"onUpdate:value":e[2]||(e[2]=o=>N.value=o),"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"input-type":"letter-numeric",conditionalClass:["one","two","three","four","five","six"],onOnChange:P,onOnComplete:D},null,8,["value"]),$.value?(i(),f("p",$e,"Pin salah, silahkan coba lagi.")):I("",!0)])]),_:1},8,["show"])],64))}};export{Ke as default};
